<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>04  Fetching  recipient details   </title>

    <link rel="stylesheet" href="../../css/bootstrap.css">
    <link rel="stylesheet" href="../../css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="../../css/template.css">
    <link rel="stylesheet" href="pad.css" />


</head>

<body>

    <div class="container">

        <h1>  Fetching recipient details    </h1>

        <a href="http://uplifter-mirajey.rhcloud.com/" target="_blank"> Experiment hosted on openshift </a>

        <hr />
        <h2> About this experiment</h2>

        <p>
            In this experiment, for  details of a recipient are fetched from databases.This is done using 
            /rest/details/:id service which provides the necessary data. Here "id" is parsed using  req.params.id.
            This id is used to query the database to get the details. 
        </p>


        <hr />

        <h2>Code snippet</h2>





        <pre> 

    app.get('/rest/details/:id', function(req, res){
	var id = req.params.id
 	
	User.findById(req.params.id, function(err, user) {
		  if(err) console.log(err);
		
		  var details = {};
		
		  details.id = user._id,
		  details.username = user.username,
		  details.name = user.first + ' ' +  user.last ;
		  details.email = user.email;
		  details.address = user.address;
		  details.imgurl = user.imgurl;
		  details.role = user.role;
		  
		  details.amount = user.need.amount;
		  details.amountReceived = user.need.amountReceived;
		  details.summary = user.need.summary;
		  details.text = user.need.text;
		  res.send(details);  
	  }); 
	
    });
 });
        </pre>

        <h2>Code source</h2>
        <a href="../../fileview/Default.aspx?~/experiments/week11/src/home/home.html" target="_blank">Home HTML Source</a>
        <br /><br />
        <a href="../../fileview/Default.aspx?~/experiments/week11/src/register/register.html" target="_blank">Register HTML Source</a>
        <br /><br />

        <a href="../../fileview/Default.aspx?~/experiments/week11/src/view/view.html" target="_blank">View HTML Source</a>
        <br /><br />

        <a href="../../fileview/Default.aspx?~/experiments/week11/src/view/viewController.js" target="_blank">View controller source code </a>
        <br /><br />

        <a href="../../fileview/Default.aspx?~/experiments/week11/src/register/registerController.js" target="_blank">register controller source code </a>
        <br /><br />

        <a href="../../fileview/Default.aspx?~/experiments/week11/src/app.js" target="_blank">client app source code </a>
        <br /><br />

        <a href="../../fileview/Default.aspx?~/experiments/week11/src/server.js" target="_blank">server.js source code</a>
        <hr />

        <h2>Reference</h2>
        <a href="https://www.youtube.com/watch?v=8GL5WpQ0vfo" target="_blank"> Prof. Jose's lecture </a>
    </div>

</body>
</html>
